# Malware Analysis: Understanding Virtual Memory and the Portable Executable File Format

### What is a Process and How to the OS Identifies Running Processes

A process can be defined as a running instance of a program. When you click on an .exe file on Windows, the OS loads the
programs data into memory creating a process based on the PE headers defined within the executable file. Creating a process is simple,
here is C program that can be compiled into an exe file:

```
#include <stdio.h>

int main()
{
  while(1);
  return 0;
}
```

The C program above, when compiled into a exe file, runs indefinitely, allowing us to analyze the created process by using a process manager
like Process Hacker or Process Explorer. If you run one of these tools and then run the exe file, you should see the creation of a new process named after the exe's name. Using a tool like Process Hacker, you can view information like the parent process ID (PPID), process ID (PID), and
the file path to executable file we launched. Processes can have the same name and have the same source file. The OS does not identify a process
by it's human readable name but rather by it's PID. So say you named your exe file, `test.exe`. You can have several instances of test.exe 
running, but each will be assigned it's own process ID.

After running the exe file and analyzing the process hierarchy displayed in Process Hacker, you should be able to discern the parent process id
that launched our executable file. For example, say you ran the exe file twice from the Windows file explorer, the process hierarchy
would like something like this:

```
- explorer.exe
     - test.exe
     - test.exe
```

This means that parent process ID (PPID) for both the `test.exe` processes is equal to the process ID of the `explorer.exe` file. In Process Hacker, doublie-clicking on any process will open a new window with more information about the process. Two important sections to remember
to look at when analyzing malware is located under the General tab and named **Command-Line** and **Current Directory**. The **Command-Line**
property displays any CLI arguments that were passed into the program. This is crucial when analyzing malware because some malware receive their instructions as program arguments. Malware that is expected to run with parameters may not expose it's true intent until provided
with the correct arguments. Not passing any programs to malware may allow the adversaries to subvert malware analysts and anti-malware
products by disabling it's intentions until the malware has bypassed defenses. The **Current Directory** property tells us the full path
from which the exe file was launched from.

### Virtual Memory

